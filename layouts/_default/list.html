{{ define "main" }}
<main class="wrap">

  <h1>{{ .Title }}</h1>

  {{/* 1. 메뉴에 정의된 섹션 slug 수집 (list, beginning 제외) */}}
  {{ $sections := slice }}
  {{ range .Site.Params.section_menu }}
    {{ if and (ne .slug "list") (ne .slug "beginning") }}
      {{ $sections = $sections | append .slug }}
    {{ end }}
  {{ end }}

  {{/* 2. 모든 섹션의 글 모으기 */}}
  {{ $pages := where .Site.RegularPages "Section" "in" $sections }}

  {{/* 3. 정렬 규칙 */}}
  {{ $ordered := $pages.ByDate.Reverse }}
  {{ if eq .Section "beginning" }}
    {{ $ordered = $pages.ByDate }}
  {{ end }}

  {{ if gt (len $ordered) 0 }}
    <ol class="postlist">
      {{ range $i, $p := $ordered }}
        <li>
          <span class="postnum">{{ add $i 1 }}.</span>
          <a href="{{ $p.RelPermalink }}">{{ $p.Title }}</a>
        </li>
      {{ end }}
    </ol>
  {{ else }}
    <p>아직 글이 없습니다.</p>
  {{ end }}

</main>
{{ end }}
